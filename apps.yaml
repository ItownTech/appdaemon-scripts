#################################################################
## Global
#################################################################
global_modules:
  - secrets
  - messages
  - globals

#################################################################
## Security
#################################################################
detectWrongStateWhenLeaving:
  module: detectWrongStateWhenLeaving
  class: DetectWrongStateWhenLeaving
  sensor: "binary_sensor.door_window_sensor_158d000205b808,binary_sensor.door_window_sensor_158d00020499ad,\
  media_player.denon_avrx1300w,switch.large_lamp,switch.small_lamp,switch.snowboard,light.bedroom_yeelight,\
  light.bar_table,light.lobby_yeelight,light.reading_lamp_yeelight,light.treppe_oben,light.stairs_lower_yeelight,switch.ventilator"
  isHome: input_boolean.is_home

detectDoorOpenWhenGoingToBed:
  module: detectDoorOpenWhenGoingToBed
  class: DetectDoorOpenWhenGoingToBed
  sensor: binary_sensor.door_window_sensor_158d000205b808
  entity: light.bedroom_yeelight
  after_sundown: True
  notify_name: group_notifications
  global_dependencies:
    - globals
    - messages

notfiyOfActionWhenAway:
  module: notfiyOfActionWhenAway
  class: NotfiyOfActionWhenAway
  sensor: "binary_sensor.door_window_sensor_158d000126a57b,binary_sensor.door_window_sensor_158d0001bb4d94,\
  binary_sensor.door_window_sensor_158d0001bb4dc0,binary_sensor.door_window_sensor_158d000205b808,\
  binary_sensor.door_window_sensor_158d000205b82e,binary_sensor.door_window_sensor_158d00020498b6,\
  binary_sensor.door_window_sensor_158d000204ba26,binary_sensor.door_window_sensor_158d0002059ddf,\
  binary_sensor.door_window_sensor_158d00020499ad,binary_sensor.door_window_sensor_158d0002048951,\
  binary_sensor.door_window_sensor_158d00020455bf,binary_sensor.motion_sensor_158d00012aab97,\
  binary_sensor.motion_sensor_158d0001fa464b,binary_sensor.motion_sensor_158d0002006cfa"
  isHome: input_boolean.is_home
  user_name: group_notifications
  isHome_delay: 20
  global_dependencies:
    - messages
    - globals

faceboxNotifier:
  module: faceboxNotifier
  class: FaceboxNotifier
  sensor: binary_sensor.door_window_sensor_158d000126a57b
  button: binary_sensor.switch_158d00012db9e5
  camera: camera.android_ip_webcam_door
  local_file_camera: camera.saved_image
  filename: secret_facebox_notifier_filename
  image_processing: image_processing.facebox
  known_faces: secret_name_user_one,secret_name_user_two
  notify_name: group_notifications
  wol_switch: switch.facebox_wol
  user_id: secret_telegram_user_id
  facebox_source_directory: secret_facebox_folderpath
  facebox_unknown_directory: secret_facebox_unknown_directory
  facebox_noface_directory: secret_facebox_noface_directory
  number_of_images: 10
  waitBeforeSnapshot: 2.5
  global_dependencies:
    - globals
    - messages

faceboxMultipleSnapshots:
  module: faceboxMultipleSnapshots
  class: FaceboxMultipleSnapshots
  sensor: binary_sensor.door_window_sensor_158d000126a57b
  button: binary_sensor.switch_158d00012db9e5
  camera: camera.android_ip_webcam_door
  filename: secret_facebox_notifier_filename
  image_processing: image_processing.facebox
  known_faces: secret_name_user_one,secret_name_user_two
  notify_name: group_notifications
  wol_switch: switch.facebox_wol
  user_id: secret_telegram_user_id
  facebox_source_directory: secret_facebox_folderpath_multiple
  facebox_unknown_directory: secret_facebox_unknown_directory
  facebox_noface_directory: secret_facebox_noface_directory
  global_dependencies:
    - globals
    - messages

faceboxTeacher:
  module: faceboxTeacher
  class: FaceboxTeacher
  folderpath: secret_facebox_folderpath
  image_processing_healthcheck: image_processing.facebox_health_check_picture
  healthcheck_face_name: secret_name_user_one
  wol_switch: switch.facebox_wol
  ip: secret_facebox_ip
  port: secret_facebox_port
  global_dependencies:
    - globals
    - messages
  
#################################################################
## eventMonitor
#################################################################
#eventMonitor:
#  module: eventMonitor
#  class: Monitor
#  events: 

#################################################################
## ButtonClicked
#################################################################

xiaomiroundButtonBedroomClicked:
  module: buttonClicked
  class: ButtonClicked
  sensor: binary_sensor.switch_158d0001b12a12
  actor_single: light.bedroom_yeelight
  actor_double: group.all

#################################################################
## MotionTrigger
#################################################################
obenTreppeMotionTrigger:
  module: motionTrigger
  class: MotionTrigger
  sensor: binary_sensor.motion_sensor_158d00012aab97
  entity_on: light.treppe_oben
  entity_off: light.treppe_oben
  after_sundown: True

bedroomMotionTrigger:
  module: bedroomMotionTrigger
  class: BedroomMotionTrigger
  sensor: binary_sensor.motion_sensor_158d0002006cfa
  entity_on: light.bedroom_yeelight
  after_sundown: True
  after: "22:00"
  constraint_entities_off: binary_sensor.door_window_sensor_158d0001bb4d94
  location_user_one_sensor: sensor.location_user_one
  location_user_two_sensor: sensor.location_user_two
  bedroom_state: Schlafzimmer
#################################################################
## ComingHome
#################################################################
#Switch on Lobby lamp when the first person is coming home and the sun is down
comingHomeYeelight:
  module: comingHome
  class: ComingHome
  sensor: binary_sensor.door_window_sensor_158d000126a57b
  isHome: input_boolean.is_home
  actor: light.lobby_yeelight
  after_sundown: True

comingHomeAlexa:
  module: comingHome
  class: ComingHome
  sensor: binary_sensor.door_window_sensor_158d000126a57b
  isHome: input_boolean.is_home
  actor: script.receiver_set_source_cbl_sat
  
#Notification if user one arrives at home
homeArrivalNotifierUserOne:
  module: homeArrivalNotifier
  class: HomeArrivalNotifier
  input_boolean: input_boolean.user_one_home
  notify_name: group_notifications
  user_name: secret_name_user_one
  zone_name: Home
  global_dependencies:
    - secrets
    - messages

#Notification if user two arrives at home
homeArrivalNotifierUserTwo:
  module: homeArrivalNotifier
  class: HomeArrivalNotifier
  input_boolean: input_boolean.user_two_home
  notify_name: group_notifications
  user_name: secret_name_user_two
  zone_name: Home
  global_dependencies:
    - secrets
    - messages 
#################################################################
## Presence
#################################################################
#Control the isHome state. Determines if someone is home or all persons are away
isHomeDeterminer:
  module: isHomeDeterminer
  class: IsHomeDeterminer
  ishome: input_boolean.is_home
  input_booleans: input_boolean.user_one_home,input_boolean.user_two_home
  global_dependencies:
    - messages
    - secrets

#Determine if user one gets/leaves home
isUserHomeDeterminerUserOne:
  module: isUserHomeDeterminer
  class: IsUserHomeDeterminer
  input_boolean: input_boolean.user_one_home
  device_tracker: secret_device_user_one
  door_sensor: binary_sensor.door_window_sensor_158d000126a57b
  global_dependencies:
    - secrets
    - messages

#Determine if user two gets/leaves home
isUserHomeDeterminerUserTwo:
  module: isUserHomeDeterminer
  class: IsUserHomeDeterminer
  input_boolean: input_boolean.user_two_home
  device_tracker: secret_device_user_two
  door_sensor: binary_sensor.door_window_sensor_158d000126a57b
  global_dependencies:
    - secrets
    - messages   
#################################################################
## DeviceNotify
#################################################################
newWifiDeviceNotify:
  module: newWifiDeviceNotify
  class: DeviceNotify
  global_dependencies:
    - messages
#################################################################
## NotifyFailedLogin
#################################################################
notifyFailedLogin:
  module: notifyFailedLogin
  class: NotifyFailedLogin
  notify_name: group_notifications
  global_dependencies:
    - messages
    - secrets
#################################################################
## GoogleTravelTime
#################################################################
googleTravelTime_home_from_work:
  module: google_travel_time
  class: GoogleTravelTime
  sensor: sensor.travel_time_home_from_work
  notify_input_boolean: input_boolean.travel_time_home_from_work
  notify_name: group_notifications
  global_dependencies:
    - secrets
    - messages

googleTravelTime_work_from_home:
  module: google_travel_time
  class: GoogleTravelTime
  sensor: sensor.travel_time_work_from_home
  notify_input_boolean: input_boolean.travel_time_work_from_home
  notify_name: group_notifications
  global_dependencies:
    - secrets
    - messages

googleTravelTime_elmo_from_home:
  module: google_travel_time
  class: GoogleTravelTime
  sensor: sensor.travel_time_elmo_from_home
  notify_input_boolean: input_boolean.travel_time_elmo_from_home
  notify_name: group_notifications
  global_dependencies:
    - secrets
    - messages

nextApppointmentLeaveNotifier:
  module: nextApppointmentLeaveNotifier
  class: NextApppointmentLeaveNotifier
  sensor: sensor.calc_leave_time
  notify_input_boolean: input_boolean.announce_time_to_leave
  notify_name: group_notifications
  input_number: input_number.leave_time_offset
  destination_name_sensor: sensor.cal_next_appointment_location
  travel_time_sensor: sensor.travel_time_next_appointment_location
  global_dependencies:
    - secrets
    - messages
#################################################################
## ZoneNotifiers
#################################################################
leavingWorkNotifierUserOne:
  module: leavingZoneNotifier
  class: LeavingZoneNotifier
  device: secret_device_user_one
  user_name: secret_name_user_one
  zone: Work
  notify_name: group_notifications
  global_dependencies:
    - secrets
    - messages

#headingHomeNotifierUserOne:
#  module: headingToZoneNotifier
#  class: HeadingToZoneNotifier
#  proximity: proximity.home_user_one
#  device: secret_name_user_one
#  user_name: secret_name_user_one
#  notify_name: secret_name_user_two
#  notify_input_boolean: input_boolean.heading_home_notifier_user_one
#  global_dependencies:
#    - secrets
#    - messages

zoneArrivalNotifier:
  module: zoneArrivalNotifier
  class: ZoneArrivalNotifier
  global_dependencies:
    - secrets
    - messages
#################################################################
## RoomBasedLightControl
#################################################################
roomBasedLightControl:
  module: roomBasedLightControl
  class: RoomBasedLightControl
  room_sensor: sensor.mqtt_room_user_one
  entity: input_boolean.room_based_light
  mappings:
    livingroom:
      room: livingroom
      entity: switch.large_lamp
    kitchen:
      room: kitchen
      entity: switch.large_lamp
    bedroom:
      room: bedroom
      entity: light.bedroom_yeelight
  global_dependencies:
    - secrets
    - messages
#################################################################
## Plants Watering Reminder
#################################################################
plantWateringNotifier:
  module: plantWateringNotifier
  class: PlantWateringNotifier
  rain_precip_sensor: sensor.dark_sky_precip_probability
  rain_precip_intensity_sensor: sensor.dark_sky_precip_intensity
  precip_type_sensor: sensor.dark_sky_precip
  notify_name: group_notifications
  user_id: secret_telegram_user_id
  reminder_acknowledged_entity: input_boolean.persistence_plantwateringnotifier_reminder_acknowledged
  global_dependencies:
    - globals
    - messages

#################################################################
## Power Usage Notification
#################################################################
powerUsageNotification_Dishwasher:
  module: powerUsageNotification
  class: PowerUsageNotification
  sensor: sensor.dishwasher_power_usage
  notify_name: group_notifications
  delay: 1260 #21 mninutes
  threshold: 2
  alternative_name: Die Spülmaschine
  global_dependencies:
    - globals
    - messages
powerUsageNotification_Washingmachine:
  module: powerUsageNotification
  class: PowerUsageNotification
  sensor: sensor.washingmachine_power_usage
  notify_name: group_notifications
  delay: 60
  threshold: 2
  alternative_name: Die Waschmaschine
  global_dependencies:
    - globals
    - messages
#################################################################
## Homeassistant Restart
#################################################################
turnOffBarAfterRestart:
  module: turnOffBarAfterRestart
  class: TurnOffBarAfterRestart
  light: light.bar_table
  global_dependencies:
    - globals
#################################################################
## Standard Resetter
#################################################################
standardSetterTravelModeNextAppointment:
  module: standardSetter
  class: StandardSetter
  entity: input_select.next_appointment_travel_mode
  standard_entity: input_select.next_appointment_travel_mode_standard
  trigger_entity: sensor.cal_next_appointment_title
  global_dependencies:
    - globals
#################################################################
## Alarm Clock
#################################################################
alarmClock:
  module: alarmClock
  class: AlarmClock
  alarm_time: sensor.alarm_time
  wakemeup: input_boolean.wakemeup
  naturalwakeup: input_number.alarm_natural_wakeup_fade_in
  alarmweekday: input_boolean.alarmweekday
  radiowakeup: input_boolean.radiowakeup
  #TODO radioplayer: input_select.wakeup_radioplayer
  wakeup_light: light.bedroom_yeelight
  isweekday: binary_sensor.workday_today
  notify_name: group_notifications
  global_dependencies:
    - globals
    - messages
    
